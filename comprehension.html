<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mathcloud Tutorial - Reading Comprehension</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f0f8ff;
      margin: 0;
      padding: 0;
      color: #333;
    }
    header {
      background: #0066cc;
      color: white;
      text-align: center;
      padding: 1rem;
    }
    .container {
      max-width: 900px;
      margin: auto;
      padding: 20px;
    }
    .student-info {
      margin-bottom: 20px;
      background: #eaf4ff;
      padding: 15px;
      border-radius: 8px;
    }
    input {
      padding: 8px;
      margin: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
      width: 95%;
    }
    button {
      padding: 8px 15px;
      margin: 5px;
      border: none;
      border-radius: 6px;
      background: #0066cc;
      color: white;
      cursor: pointer;
    }
    button:hover { background: #004d99; }
    details {
      margin-bottom: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 8px;
      background: white;
    }
    summary {
      font-weight: bold;
      cursor: pointer;
      color: #0066cc;
    }
    .question {
      margin: 10px 0;
    }
    textarea {
      width: 95%;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #aaa;
    }
  </style>
</head>
<body>
  <header>
    <h1>ðŸ“– Mathcloud Tutorial</h1>
    <h2>Interactive Reading & Comprehension</h2>
  </header>

  <div class="container">
    <div class="student-info">
      <label>Student Name:</label><br>
      <input type="text" id="studentName"><br>
      <label>Class:</label><br>
      <input type="text" id="studentClass">
    </div>

    <!-- === PASSAGE TOGGLES === -->
    <div id="passages"></div>

    <button onclick="submitAnswers()">Submit Answers</button>
  </div>

  <script type="module">
    // Firebase config
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAFsHg9fK6IDnHbuxmBleEfIIfVGsuLDik",
      authDomain: "profile-b825d.firebaseapp.com",
      projectId: "profile-b825d",
      storageBucket: "profile-b825d.firebasestorage.app",
      messagingSenderId: "925276859161",
      appId: "1:925276859161:web:194c60f6dbd9f1ef8bf388"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Passages & Questions
    const data = [
      {
        passage: "One sunny morning, Emma found a lost puppy near her house. She took it home, gave it milk, and promised to find its owner.",
        questions: [
          "Who found the puppy?",
          "When did Emma find the puppy?",
          "What did Emma give the puppy?",
          "What promise did Emma make?",
          "Where did Emma find the puppy?"
        ]
      },
      {
        passage: "The Nile River in Egypt is one of the longest rivers in the world. It has helped people grow crops for thousands of years.",
        questions: [
          "Where is the Nile River located?",
          "What is special about the Nile?",
          "What has the Nile helped people to do?",
          "How long have people used the Nile?",
          "Which country does the passage mention?"
        ]
      },
      {
        passage: "Birds migrate to warmer places during winter. They fly in groups called flocks and return in the spring.",
        questions: [
          "What do birds do in winter?",
          "What is a group of birds called?",
          "When do birds return?",
          "Why do birds migrate?",
          "What season do birds come back?"
        ]
      },
      {
        passage: "Thomas Edison invented the electric bulb. His invention changed the way people lived and worked.",
        questions: [
          "Who invented the bulb?",
          "What did he invent?",
          "How did his invention change lives?",
          "What is the full name of Edison?",
          "What did the bulb replace at night?"
        ]
      },
      {
        passage: "The cheetah is the fastest land animal. It can run up to 120 kilometers per hour while chasing prey.",
        questions: [
          "Which animal is the fastest?",
          "How fast can a cheetah run?",
          "Why does it run so fast?",
          "What does the cheetah chase?",
          "What type of animal is the cheetah?"
        ]
      },
      {
        passage: "Mount Everest is the tallest mountain in the world. Many climbers try to reach its peak every year.",
        questions: [
          "What is Mount Everest?",
          "Where is Mount Everest?",
          "What do climbers try to reach?",
          "How often do climbers attempt this?",
          "What is special about Everest?"
        ]
      },
      {
        passage: "Honeybees live in hives and make honey. They are very important for pollinating flowers and crops.",
        questions: [
          "Where do honeybees live?",
          "What do honeybees make?",
          "Why are they important?",
          "What do honeybees pollinate?",
          "What is the home of bees called?"
        ]
      }
    ];

    // Render passages
    const container = document.getElementById("passages");
    data.forEach((item, i) => {
      const block = document.createElement("details");
      block.innerHTML = `
        <summary>Passage ${i+1}</summary>
        <p>${item.passage} 
        <button onclick="readText('${item.passage.replace(/'/g, "\\'")}')">ðŸ”Š Read Aloud</button></p>
        ${item.questions.map((q,j) => `
          <details>
            <summary>Question ${j+1}</summary>
            <div class="question">${q} 
              <button onclick="readText('${q.replace(/'/g, "\\'")}')">ðŸ”Š</button>
              <br><textarea id="ans-${i}-${j}" placeholder="Type your answer..."></textarea>
            </div>
          </details>
        `).join("")}
      `;
      container.appendChild(block);
    });

    // Read aloud
    window.readText = function(text) {
      const speech = new SpeechSynthesisUtterance(text);
      speech.lang = "en-US";
      window.speechSynthesis.speak(speech);
    }

    // Submit answers
    window.submitAnswers = async function() {
      const name = document.getElementById("studentName").value.trim();
      const cls = document.getElementById("studentClass").value.trim();
      if (!name || !cls) {
        alert("Please enter your name and class!");
        return;
      }
      const answers = {};
      data.forEach((item,i)=>{
        item.questions.forEach((q,j)=>{
          const val = document.getElementById(`ans-${i}-${j}`).value.trim();
          answers[`Passage${i+1}_Q${j+1}`] = val;
        });
      });
      await addDoc(collection(db,"comprehensionAnswers"), {
        name, class: cls, answers, timestamp: new Date()
      });
      alert("âœ… Answers submitted successfully!");
    }
  </script>
</body>
</html>
